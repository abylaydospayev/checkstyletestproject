# Cpt S 422: Custom Checkstyle Metrics



 Abylay Dospayev

 Cpts 422

Fall 2025

Implementation and validation of code metrics checks for Checkstyle.



---



## 1. Implemented Checks and Metric Assumptions



The project includes three core metrics checks, extending `AbstractCheck`, that traverse the Abstract Syntax Tree (AST) generated by Checkstyle.



### 1.1. OperatorCountCheck



**What it does:** Counts the total number of operators in a Java file.



**Explicit Assumptions & Scope:**

1.  **Operators Defined:** Operators are counted based on a fixed set of token types including arithmetic (`+`, `-`), assignment (`=`, `+=`), comparison (`<`, `==`), logical (`&&`, `||`), and unary (`++`, `--`).

2.  **Exclusions:** The check correctly ignores any symbols or keywords that appear inside String literals.



### 1.2. LoopCountCheck



**What it does:** Counts the total number of looping statements (`for`, `while`, `do-while`) in a Java file.



**Explicit Assumptions & Scope:**

1.  **Loop Types:** Counts `LITERAL_FOR` (including enhanced for-each), `LITERAL_WHILE`, and `LITERAL_DO`.

2.  **Do-While Rule (Assumption):** A full `do { ... } while (...);` block is counted **exactly once**. The implementation checks the parent of the `LITERAL_WHILE` token; if the parent is `LITERAL_DO`, the `WHILE` token is ignored to prevent double-counting.



### 1.3. CommentCountCheck



**What it does:** Counts the total number of comments found in a file.



**Explicit Assumptions & Scope:**

1.  **Comments Defined:** Counts `SINGLE_LINE_COMMENT` (`//`) and the beginning of block comments (`BLOCK_COMMENT_BEGIN`, including Javadoc).

2.  **Engine Requirement:** The check explicitly overrides `isCommentNodesRequired()` to return `true`, ensuring the Checkstyle TreeWalker provides comment tokens.



---



## 2. Testing and Validation Summary



The project utilizes a two-step testing approach: **White-Box Unit Tests** (Deliverable 2) for code isolation and **Black-Box Tests** (Deliverable 3) for end-to-end functional validation.



### 2.1. White-Box Unit Testing (JUnit 5 & Mockito)



Unit tests primarily use Mockito to mock `DetailAST` tokens, ensuring core logic is 100% covered.



| Check | Overall Line Coverage | Uncovered Path Explanation |

| :--- | :--- | :--- |

| **OperatorCountCheck** | 95.0% | Remaining uncovered lines are primarily defensive `if (rootAST != null)` logging statements in `finishTree`. |

| **LoopCountCheck** | 88.6% | Remaining uncovered lines are defensive guard clauses in `finishTree` that are difficult to trigger in a standard unit test. |

| **CommentCountCheck** | 80.0% | Remaining uncovered lines are logging and null-checking paths in `finishTree`. |



### 2.2. Black-Box Testing (Deliverable 3)



Black-box testing was performed using **`BlackBoxTestEngine.java`**, which acts as a programmatically configured Checkstyle runner against live Java source files stored in `src/test/resources/inputs/`.



| Input File | Test Purpose (Fault Model) | Final Count | Status |

| :--- | :--- | :--- | :--- |

| `OperatorInput.java` | Test if operators in strings are ignored. | 7 Operators | **PASS** |

| `LoopInput.java` | Test nested loops and `do-while` single-counting logic. | 4 Loops | **PASS** |

| `CommentInput.java` | Test counting single and block comments and rejecting symbols in strings. | 4 Comments | **PASS** |



### 2.3. Test Engine



The **`BlackBoxTestEngine.java`** acts as the test engine required for submission. It manually sets up the Checkstyle `Checker` and nests a `TreeWalker` to run the custom checks, verifying results against expected counts derived from the fault model input files.



---



## 3. Deliverable 3 Submission Artifacts



All necessary files are included in this repository. The formal report document details the Fault Models, coverage reports, and Class Testing discussion.



* **Test Engine:** `src/test/java/checkStylePackageTest/BlackBoxTestEngine.java`

* **Black-Box Cases:** `src/test/resources/inputs/*.java`

* **Screenshot:** `Del3/screenshot.png` (showing successful execution)